# Generated by Django 3.1.14 on 2022-09-30 13:46

from django.db import migrations, models


def _update_addr_types(apps, schema_editor):
    address_model = apps.get_model('addresses', 'AddressModel')
    update_info = (
        # old_ao_type, new_ao_type, new_ao_level
        (113,  105, 1),     # Область
        (301,  201, 2),     # Район
        (401,  405, 4),     # Город
        (402,  424, 4),     # Посёлок городского типа
        (414,  314, 3),     # Сельское поселение
        (418,  405, 4),     # Город
        (605,  405, 4),     # Город
        (607,  407, 4),     # Дачный посёлок
        (621,  421, 4),     # Посёлок
        (624,  424, 4),     # Посёлок городского типа
        (629,  429, 4),     # Рабочий посёлок
        (630,  430, 4),     # Село
        (651,  424, 4),     # Посёлок городского типа
        (6506, 418, 4),     # Микрорайон
        (6509, 513, 5),     # Парк
        (6573, 525, 5),     # Строение
        (6576, 529, 5),     # Улица
        (6587, 589, 5),     # Фермерское хозяйство
        (702,  502, 5),     # Бульвар
        (714,  514, 5),     # Переулок
        (718,  518, 5),     # Проезд
        (719,  519, 5),     # Проспект
        (729,  529, 5),     # Улица
        (762,  529, 5),     # Улица
        (793,  531, 5),     # Шоссе
        (803,  601, 6),     # Дом
        # (805, ),            # Здание
        # (806, ),            # Корпус
        # (809, ),            # Павильон
        (811, 525, 5),      # Строение
        (9002, 564, 5),     # Садовое неком-е товарищество
        (9003, 590, 5),     # Промзона
        (9004, 563, 5),     # Гаражно-строительный кооп.
        # (901, ),            # Гараж
        # (902, ),            # Квартира
        # (903, ),            # Комната
        # (904, ),            # Офис
        # (905, ),            # Погреб
        # (906, ),            # Подвал
        # (907, ),            # Помещение
        # (909, ),            # Склад
        (9125, 525, 5),     # Строение
        (9130, 530, 5),     # Участок
    )
    for old_ao_type, new_ao_type, new_ao_level in update_info:
        r = address_model.objects.filter(fias_address_type=old_ao_type).update(
            fias_address_level=new_ao_level,
            fias_address_type=new_ao_type,
        )
        print(f'Updated ao {old_ao_type} -> {new_ao_type} L{new_ao_level}', r)


class Migration(migrations.Migration):

    dependencies = [
        ('addresses', '0003_remove_addr_types'),
    ]

    operations = [
        migrations.AlterField(
            model_name='addressmodel',
            name='fias_address_type',
            field=models.IntegerField(choices=[(0, '-'), (1, 'стр'), (104, 'край'), (105, 'обл'), (106, 'Респ'), (112, 'г.ф.з.'), (113, 'обл.'), (301, 'р-н'), (401, 'г'), (402, 'пгт'), (414, 'с/п'), (418, 'г.'), (605, 'г'), (607, 'дп'), (621, 'п'), (624, 'пгт'), (629, 'рп'), (630, 'с'), (651, 'пгт.'), (6506, 'мкр.'), (6509, 'парк'), (6573, 'стр.'), (6576, 'ул.'), (6587, 'ф/х'), (702, 'б-р'), (714, 'пер'), (718, 'проезд'), (719, 'пр-кт'), (729, 'ул'), (762, 'ул.'), (793, 'ш.'), (803, 'д.'), (805, 'зд.'), (806, 'к.'), (809, 'пав.'), (811, 'стр.'), (9002, 'снт'), (9003, 'промзона'), (9004, 'гск'), (901, 'г-ж'), (902, 'кв.'), (903, 'ком.'), (904, 'офис'), (905, 'п-б'), (906, 'подв.'), (907, 'помещ.'), (909, 'скл.'), (9125, 'стр'), (9130, 'уч-к')], default=0, verbose_name='FIAS address type'),
        ),
        migrations.RunPython(_update_addr_types)
    ]
